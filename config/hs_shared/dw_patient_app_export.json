{
	"database": "healthscore_dw",
	"export_table_info": [
		{
			"tablename": "dim_patient",
			"query": "select 'patient_unique_id','patient_unique_id_type','patient_nm','patient_first_nm','patient_middle_nm','patient_last_nm','patient_gender','patient_birth_ts','patient_death_ts','blood_group','contact_email_id','contact_addr_line1','contact_addr_line2','contact_addr_city_nm','contact_addr_state_nm','contact_addr_country_nm','contact_addr_zipcode','contact_home_phone_num','contact_mobile_phone_num','patient_emerg_contact_nm','patient_emerg_contact_num','patient_relation','effective_from_ts','effective_to_ts' UNION ALL SELECT src.patient_unique_id, src.patient_unique_id_type, src.patient_nm,src.patient_first_nm,src.patient_middle_nm,src.patient_last_nm,src.patient_gender,src.patient_birth_ts,src.patient_death_ts,src.blood_group,src.contact_email_id,src.contact_addr_line1,src.contact_addr_line2,src.contact_addr_city_nm,src.contact_addr_state_nm,src.contact_addr_country_nm,src.contact_addr_zipcode,src.contact_home_phone_num,src.contact_mobile_phone_num,src.patient_emerg_contact_nm,src.patient_emerg_contact_num,src.patient_relation,src.effective_from_ts,src.effective_to_ts FROM healthscore_dw.dim_patient src join healthscore_dw.map_patient_hospital mp on mp.patient_key = src.patient_key  join healthscore_dw.dim_hospital dim_h on mp.hospital_key = dim_h.hospital_key",
			"where_clause": "dim_h.patient_app_flg = 1"
		},
		{
			"tablename": "map_patient_hospital",
			"query": "select 'patient_unique_id','hospital_cd',' hospital_patient_cd',' rate_category_nm' union all select dim_p.patient_unique_id,src.hospital_cd,src.hospital_patient_cd,src.default_rate_category_nm FROM healthscore_dw.map_patient_hospital src join healthscore_dw.dim_patient dim_p on dim_p.patient_key=src.patient_key join healthscore_dw.dim_hospital dim_h on dim_h.hospital_key=src.hospital_key",
			"where_clause": "dim_h.patient_app_flg = 1"
		},
		{
			"tablename": "hs_package_master",
			"query": "select 'hospital_cd','package_cd','package_nm','package_amt','package_desc','rate_category_nm','active_flg','pkg_effective_from_ts','pkg_effective_to_ts','renewal_amt','renewal_reminder_days','validity_no_days','display_seq_no' union all  select distinct dim_h.hospital_cd, src.bill_item_category_cd as package_cd,bill_item_category_nm as package_nm,JSON_EXTRACT(src.bill_item_category_desc,'$.pkg_amt') as package_amt,JSON_EXTRACT(src.bill_item_category_desc,'$.package_desc') as package_desc,upper(rate_category_nm) as rate_category_nm,src.active_flg, src.pkg_effective_from_ts, src.pkg_effective_to_ts, JSON_EXTRACT(src.bill_item_category_desc,'$.renewal_amt') as renewal_amt, JSON_EXTRACT(src.bill_item_category_desc,'$.renewal_reminder_days') as renewal_reminder_days,JSON_EXTRACT(src.bill_item_category_desc,'$.validity_no_days') as validity_no_days,src.display_seq_no  from   healthscore_dw.dim_bill_items src join healthscore_dw.dim_hospital dim_h on src.hospital_key = dim_h.hospital_key join (select bill_item_category_cd, max(active_flg) as m_active_flg from healthscore_dw.dim_bill_items group by bill_item_category_cd )act on act.bill_item_category_cd=src.bill_item_category_cd  and src.active_flg=act.m_active_flg",
			"where_clause": "src.bill_item_type = 'bill_package_app_subscription' and dim_h.patient_app_flg = 1"
		},
		{
			"tablename": "hs_package_items_master",
			"query": "select 'hospital_cd','package_cd','bill_item_cd','bill_item_nm','bill_item_amt','active_flg','effective_from_ts','effective_to_ts','display_seq_no' union all select dim_h.hospital_cd, src.bill_item_category_cd as package_cd,src.bill_item_cd,src.bill_item_nm, src.bill_item_amt, src.active_flg, src.effective_from_ts, src.effective_to_ts,src.display_seq_no from healthscore_dw.dim_bill_items src  join healthscore_dw.dim_hospital dim_h on src.hospital_key = dim_h.hospital_key ",
			"where_clause": "src.bill_item_type = 'bill_package_app_subscription' and dim_h.patient_app_flg = 1 and src.bill_item_cd!='NO_PKG_ITEM'"
		},
		{
			"tablename": "dim_hospital",
			"query": "select 'hospital_cd','hospital_nm','hospital_addr_line1','hospital_addr_line2','hospital_addr_city_nm','hospital_addr_state_nm','hospital_addr_country_nm','hospital_addr_zipcode','hospital_phone_num','hospital_email_addr','hospital_logo','convenience_fee','convenience_pct_flg','razorpay_account_id','patient_app_flg' union all select src.hospital_cd,src.hospital_nm,src.hospital_addr_line1,src.hospital_addr_line2,src.hospital_addr_city_nm,src.hospital_addr_state_nm,src.hospital_addr_country_nm,src.hospital_addr_zipcode,src.hospital_phone_num,src.hospital_email_addr,src.hospital_logo,src.convenience_fee,src.convenience_pct_flg,src.razorpay_account_id,patient_app_flg  from healthscore_dw.dim_hospital src",
			"where_clause": "src.patient_app_flg = 1"
		}
	]
}
